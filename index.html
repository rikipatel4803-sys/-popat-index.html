<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Popat Capture Quest ğŸ’š</title>

<style>
:root{
  --pink:#ff4d6d;
  --bg:linear-gradient(135deg,#a8edea,#fed6e3);
}

*{margin:0;padding:0;box-sizing:border-box;font-family:'Comic Sans MS',cursive;}

body{
  height:100vh;
  background:var(--bg);
  overflow:hidden;
}

/* overlay */
#overlay{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.6);
  color:#fff;
  font-size:22px;
  z-index:50;
}

/* popat */
#popat{
  position:absolute;
  font-size:72px;
  cursor:pointer;
  user-select:none;
  transform:translate(-50%,-50%);
}

/* final card */
#card{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:10;
}

.card-inner{
  background:#fff;
  padding:30px;
  width:90%;
  max-width:420px;
  border-radius:30px;
  text-align:center;
  box-shadow:0 25px 50px rgba(0,0,0,.3);
  animation:pop .6s ease;
}

@keyframes pop{
  from{transform:scale(.7);opacity:0;}
  to{transform:scale(1);opacity:1;}
}

h1{color:var(--pink);margin-bottom:10px;}
p{font-size:17px;color:#333}

/* confetti */
.confetti{
  position:absolute;
  width:8px;height:8px;
  animation:fall 2s linear forwards;
}
@keyframes fall{
  to{transform:translateY(100vh) rotate(360deg);opacity:0;}
}

/* fireworks */
.spark{
  position:absolute;
  width:6px;height:6px;
  background:gold;
  border-radius:50%;
  animation:boom 1s ease-out forwards;
}
@keyframes boom{
  to{transform:scale(25);opacity:0;}
}
</style>
</head>

<body>

<div id="overlay">Tap anywhere to start ğŸµ</div>

<audio id="music" loop>
  <source src="Relax_with_Soft_Piano_Music_Birds_Singing_Beautiful_Nature_256KBPS.mp3">
</audio>

<div id="popat">ğŸ¦</div>

<div id="card">
  <div class="card-inner">
    <h1>Happy New Year ğŸ’š</h1>
    <p>
      Tu Popat pakad liya ğŸ˜„<br><br>
      New Year wish late ho gayi,<br>
      par tu meri life ka fixed part hai ğŸ¦ğŸ’š<br><br>
      Sorry Popat ğŸ™<br>
      âœ¨ Happy New Year âœ¨
    </p>
  </div>
</div>

<script>
/* ---------- STATE ---------- */
const STATE={INIT:0,CHASE:1,END:2};
let current=STATE.INIT;

/* ---------- ELEMENTS ---------- */
const popat=document.getElementById("popat");
const overlay=document.getElementById("overlay");
const music=document.getElementById("music");
const card=document.getElementById("card");

/* ---------- GAME DATA ---------- */
let hits=0;
let target={x:200,y:200};
let pos={x:200,y:200};
let lastHit=0;

/* ---------- START ---------- */
overlay.addEventListener("click",()=>{
  overlay.style.display="none";
  music.play();
  current=STATE.CHASE;
  moveTarget();
  animate();
});

/* ---------- POPAT MOVE LOGIC ---------- */
function moveTarget(){
  if(current!==STATE.CHASE) return;
  target.x=Math.random()*(innerWidth-80)+40;
  target.y=Math.random()*(innerHeight-80)+40;
  setTimeout(moveTarget,700);
}

function animate(){
  if(current!==STATE.CHASE) return;
  pos.x+=(target.x-pos.x)*0.08;
  pos.y+=(target.y-pos.y)*0.08;
  popat.style.left=pos.x+"px";
  popat.style.top=pos.y+"px";
  requestAnimationFrame(animate);
}

/* ---------- CAPTURE LOGIC ---------- */
popat.addEventListener("click",e=>{
  e.stopPropagation();
  const now=Date.now();
  if(now-lastHit<300) return; // debounce
  lastHit=now;
  hits++;

  popat.style.transform="translate(-50%,-50%) scale(.85)";
  setTimeout(()=>popat.style.transform="translate(-50%,-50%) scale(1)",120);

  if(hits>=4) endGame();
});

/* ---------- END ---------- */
function endGame(){
  current=STATE.END;
  popat.style.display="none";
  card.style.display="flex";
  celebrate();
}

/* ---------- CELEBRATION ---------- */
function celebrate(){
  for(let i=0;i<100;i++){
    const c=document.createElement("div");
    c.className="confetti";
    c.style.left=Math.random()*innerWidth+"px";
    c.style.top="-10px";
    c.style.background=`hsl(${Math.random()*360},100%,50%)`;
    document.body.appendChild(c);
    setTimeout(()=>c.remove(),2000);
  }
}

/* ---------- FIREWORKS ---------- */
document.body.addEventListener("click",e=>{
  if(current!==STATE.END) return;
  const s=document.createElement("div");
  s.className="spark";
  s.style.left=e.clientX+"px";
  s.style.top=e.clientY+"px";
  document.body.appendChild(s);
  setTimeout(()=>s.remove(),1000);
});
</script>

</body>
</html>
